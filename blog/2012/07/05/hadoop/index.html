
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hadoop - My Octopress Blog</title>
  <meta name="author" content="windfire.cd">

  
  <meta name="description" content="简介 Apache Hadoop是一个开源的基于集群的分布式处理大数据的计算框架。
它用于将一个机器处理的问题切分为若干提供存储和计算资源的机器共同处理的问题，对于集群来说，
集群中的任何机器都可能失效，它提供基于应用层的异常处理功能。 Apache Hadoop项目分为三个子项目 [Hadoop &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://windfire-cd.github.com/blog/2012/07/05/hadoop/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>life and I</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:windfire-cd.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Hadoop</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-07-05T18:14:00+08:00" pubdate data-updated="true">Jul 5<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>简介</h2>

<p><a href="http://hadoop.apache.org/">Apache Hadoop</a>是一个开源的基于集群的分布式处理大数据的计算框架。
它用于将一个机器处理的问题切分为若干提供存储和计算资源的机器共同处理的问题，对于集群来说，
集群中的任何机器都可能失效，它提供基于应用层的异常处理功能。</p>

<p><a href="http://hadoop.apache.org/">Apache Hadoop</a>项目分为三个子项目</p>

<ul>
<li>[Hadoop Common]</li>
</ul>


<p>hadoop主要克隆了Google运行系统的框架，包括</p>

<ul>
<li>文件系统HDFS</li>
<li>计算框架MapReduce</li>
<li>结构化数据处理HBase</li>
</ul>


<p>基于此的其他开源项目</p>

<ul>
<li>Pig</li>
<li>Zookeeper</li>
<li>HIVE</li>
</ul>


<p>大数据存储和访问</p>

<p>关系型数据库和MapReduce差异</p>

<p><strong>网格计算</strong></p>

<p>大规模分布式的主要问题是处理失效和错误</p>

<h2>MapReduce简介</h2>

<p>一种用于数据处理的编程模型，本质是并行的
分为两个阶段</p>

<ul>
<li>Map</li>
<li>Reduce</li>
</ul>


<p><strong>分支化</strong></p>

<ul>
<li>map任务</li>
<li>reduce任务</li>
</ul>


<p>两种类型节点控制作业执行</p>

<ul>
<li>jobtracker</li>
<li>tasktracker</li>
</ul>


<p><strong>输入输出流</strong></p>

<p><a href="http://hadoop.apache.org/">Apache Hadoop</a> 提供了API允许除JAVA外语言运行MapReduce，</p>

<h2>分布式文件系统</h2>

<h3>HDFS设计</h3>

<p>特点</p>

<ul>
<li>针对超大文件而设计的文件系统</li>
<li>流式数据访问</li>
<li>商用硬件</li>
</ul>


<p>缺点</p>

<ul>
<li>低延迟访问（如果需要低延迟HBase更好）</li>
<li>大量小文件</li>
<li>多用户写入，任意修改</li>
</ul>


<h3>HDFS概念</h3>

<p><strong>块</strong></p>

<ul>
<li>默认64M</li>
</ul>


<p><strong>名称节点和数据节点</strong></p>

<ul>
<li>管理者  命名空间</li>
<li>工作者  定位块</li>
</ul>


<p>命名空间损坏会造成系统失效，保证其可用有以下两种方式</p>

<ol>
<li>复制组成文件系统元数据的持久文件</li>
<li>二级名称节点</li>
</ol>


<p><strong>命令行接口</strong></p>

<ul>
<li>hadoop fs -help</li>
<li>hadoop fs -copyFromLocal input/docs/qu.txt hdfs://localhost/user/tom/qu.txt</li>
<li>md5 input/docs/qu.txt qu.copy.txt</li>
<li>hadoop fs -mkdir books</li>
<li>hadoop fs ls</li>
</ul>


<p>接口</p>

<ul>
<li>Thrift</li>
<li>libhdfs</li>
<li>fuse</li>
<li>webdav</li>
<li>http</li>
<li>ftp</li>
</ul>


<p><strong>Java接口</strong></p>

<h3>数据流</h3>

<h2>hadoop的I/O</h2>

<h3>序列化</h3>

<p>writable是MapReduce数据路径的核心。</p>

<p><strong>序列化框架</strong></p>

<h3>基于文件的数据结构</h3>

<p><strong>SequenceFile</strong></p>

<p>key/value结构</p>

<p><strong>MapFile</strong></p>

<p>sorted SequenceFile</p>

<h2>MapReduce开发</h2>

<p>大致流程</p>

<ul>
<li>编写map, reduce函数</li>
<li>单元测试</li>
<li>运行驱动作业</li>
<li>集群运行</li>
<li>调试错误</li>
<li>调整性能</li>
</ul>


<h3>配置环境</h3>

<h3>单元测试</h3>

<h3>本地运行</h3>

<h3>集群运行</h3>

<p>不需要修改，直接打包后运行</p>

<p>拥有网络观察界面</p>

<p>调试方法，日志解析方法</p>

<p>调优列表</p>

<ul>
<li>mapper数量</li>
<li>reducer数量</li>
<li>是否利用combainer</li>
<li>中间值</li>
<li>自定义序列</li>
<li>shuffle运行</li>
</ul>


<h3>MapReduce工作流</h3>

<p>高级语言</p>

<ul>
<li>Pig</li>
<li>HIHV</li>
<li>Cascading</li>
</ul>


<h2>MapReduce工作原理</h2>

<h3>运行作业</h3>

<ul>
<li>提交作业</li>
<li>作业初始化</li>
<li>任务分配</li>
<li>任务执行</li>
<li>进度状态更新</li>
<li>作业完成</li>
</ul>


<h3>失败的处理</h3>

<h3>作业调度</h3>

<p>早期FIFO使用整个</p>

<p>后来优先级队列</p>

<p>Fair Scheduler</p>

<h3>shuffle和排序</h3>

<p>shuffle&#8211; 系统排序的过程</p>

<p>优化的关键</p>

<p>很多时候是MapReduce的核心</p>

<h3>任务的执行</h3>

<h2>MapReduce类型和格式</h2>

<p>key/value输入输出</p>

<p>java本身问题导致的类型摩擦</p>

<h3>输入格式</h3>

<p>大量小文件会降低MapReduce性能，因为会增加seek操作，而且每次新map会造成性能损失，MapReduce最佳处理速度最好与数据在集群中传播速度
相同。所以将大量的小文件打包成一个整块的文件</p>

<p>hadoop擅长处理结构化的数据</p>

<p>文本和文件格式的输入</p>

<p>数据库输入</p>

<h3>输出格式</h3>

<p>一个分区对应一个固定的分区不好，导致分区不均。</p>

<p>让很多reducer去做较轻的工作也不佳，更好的是用少量的reducer,每个做更多的活，这样便于管理reducer.</p>

<h2>MapReduce特性</h2>

<ul>
<li>计数器</li>
<li>排序</li>
<li>数据集链接</li>
</ul>


<p>对数据排序是MapReduce的核心。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">windfire.cd</span></span>

      








  


<time datetime="2012-07-05T18:14:00+08:00" pubdate data-updated="true">Jul 5<span>th</span>, 2012</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://windfire-cd.github.com/blog/2012/07/05/hadoop/" data-via="" data-counturl="http://windfire-cd.github.com/blog/2012/07/05/hadoop/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/07/04/buildbot-test-framework/" title="Previous Post: BuildBot Test Framework">&laquo; BuildBot Test Framework</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/07/09/bitcask/" title="Next Post: bitcask">bitcask &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/07/31/thrift/">Thrift</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/31/log4jshi-yong/">log4j使用</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/26/mockito/">Mockito</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/25/maven2/">Maven2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/19/javashe-ji-mo-shi/">java设计模式</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - windfire.cd -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'windfire-cd-comments';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://windfire-cd.github.com/blog/2012/07/05/hadoop/';
        var disqus_url = 'http://windfire-cd.github.com/blog/2012/07/05/hadoop/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
